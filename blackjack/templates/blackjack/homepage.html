<!DOCTYPE html>
<html>
<body>

<h1>Welcome to Blackjack!</h1>

<label for="n_players">select number of players/spots</label>
<select name="n_players" id="n_players">
    <option value=1>1</option>
    <option value=2>2</option>
    <option value=3 selected="selected">3</option>
    <option value=4>4</option>
    <option value=5>5</option>
    <option value=6>6</option>
    <option value=7>7</option>
</select>

<div id="reserved">
    <table id="dynamic_table">
    </table>
</div>

<script>
    function shuffle_cards() {
        var req = new XMLHttpRequest();
        var nPlayers = document.getElementById("n_players").value;
        var tbl = document.getElementById("dynamic_table");

        req.onreadystatechange = function() {
            if (req.readyState == 4 && req.status == 200) {
                var json_obj = JSON.parse(req.responseText);
                tbl.innerHTML = ""
                for (var i = 1; i <= nPlayers; i++) {
                    var row = document.createElement("tr");
                    var pkey = `players_cards_${i}`;
                    for (var j = 0; j < json_obj[pkey].length; j++) {
                        var cell = document.createElement("td");
                        var cellText = document.createTextNode(json_obj[pkey][j]);
                        cell.appendChild(cellText);
                        row.appendChild(cell);
                    }
                    tbl.appendChild(row);
                }
            }
            else {
                // TODO: show error message here
            }
        };
        req.open("GET", document.URL + `restart?n_players=${nPlayers}`, true);
        req.send(null);
    }
</script>
<button onclick="shuffle_cards()">Shuffle</button>

</body>
</html>